sequence
(
  args
  (
    keyValue
    (
      "@email"
      "riotestaa@qq.com"
    )
    keyValue
    (
      "@wrongemail"
      "riotesttestaa@qq.com"
    )
    keyValue
    (
      "@password"
      "a123456"
    )
    keyValue
    (
      "@wrongpwd"
      "qweasdzxc"
    )
    keyValue
    (
      "@employee"
      "?employee=riotest"
    )
    keyValue
    (
      "@wrongemployee"
      "?employee=riotesttest"
    )
    keyValue
    (
      "@path"
      "https://elifetransfer.s3.us-east-2.amazonaws.com/dev/flt_mgmt/flt_mgmt.html"
    )
    keyValue
    (
      "@loginnote"
      "riotest logined via riotestaa@qq"
    )
    keyValue
    (
      "@acctitle"
      "Sorry, you have no permission to access account"
    )
    keyValue
    (
      "@signtitle2"
      "Welcome to Elife!"
    )
    keyValue
    (
      "@testtitle"
      "Finished Rides"
    )
  )
  assign
  (
    @_resumeInterval
    valueOf
    (
      100
    )
  )
  print
  ^ 测试标题：员工登录，测试点：登录日志，account信息屏蔽
  (
    "TEST:  Employee Sign"
  )
  assign
  (
    @app
    webBrowser
    (
      "Chrome"
    )
  )
  assign
  (
    @_resumeInterval
    valueOf
    (
      2000
    )
  )
  webBrowserPage
  ^ 打开app, 登录错误员工账号+正确车队账号+正确密码登录失败
  (
    @app
    str
    (
      @path
      @wrongemployee
    )
  )
  webPageElementInput
  ^ 输入正确车队账号
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-email\"]"
    100
    3
    @email
  )
  webPageElementInput
  ^ 输入正确密码
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @password
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"agr-checkbox\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  ^ 点击登录，登录失败提示"Incorrect account or password"
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  webBrowserPage
  ^ 打开app, 登录正确员工账号+正确车队账号+正确密码登录失败
  (
    @app
    str
    (
      @path
      @employee
    )
  )
  webPageElementInput
  ^ 输入错误车队账号
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-email\"]"
    100
    3
    @wrongemail
  )
  webPageElementInput
  ^ 输入正确密码
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @password
  )
  webPageElementClick
  ^ 查看密码
  (
    @app
    "xpath"
    "//*[@id=\"eye-icon\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"agr-checkbox\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  ^ 点击登录，登录失败提示"Incorrect account or password"
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementInput
  ^ 输入正确车队账号
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-email\"]"
    100
    3
    @email
  )
  webPageElementInput
  ^ 输入错误密码
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @wrongpwd
  )
  webPageElementClick
  ^ 点击登录，登录失败提示"Incorrect account or password"
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementInput
  ^ 输入正确密码
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @password
  )
  webPageElementClick
  ^ 点击登录，登录成功
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  assign
  (
    @new
    dateTimeNow
    (
    )
  )
  assign
  (
    @time
    dateTimeFormat
    (
      @new
      "yyyy-MM-dd HH:mm:ee"
    )
  )
  assign
  (
    @db
    dbSqlConn
    ^ 连接数据库
    (
      "com.mysql.jdbc.Driver"
      str
      (
        "jdbc:mysql://"
        "rideprod.c9y2b7qgnkr8.us-east-2.rds.amazonaws.com"
        ":"
        3306
      )
      "dev_user"
      "0TAnwLmMzDbCYMuf"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "use ride"
    )
  )
  assign
  (
    @logs
    tableStream
    (
      streamDbSql
      (
        @db
        "select notes,inserted_at from note_fleet order by id desc limit 1"
      )
    )
  )
  assign
  (
    @notes
    selInPlace
    (
      @logs
      0
      0
    )
  )
  assign
  (
    @notestime
    selInPlace
    (
      @logs
      0
      1
    )
  )
  assign
  (
    @iftime1
    strSub
    ^ 提取当前时间年月日小时分钟
    (
      @time
      0
      16
    )
  )
  assign
  (
    @iftime2
    strSub
    ^ 提取日志创建时间年月日小时分钟
    (
      str
      (
        @notestime
      )
      0
      16
    )
  )
  if
  ^ 判断员工登录日志创建时间
  (
    equal
    (
      @iftime1
      @iftime2
    )
    print
    (
      str
      (
        "1.   PASS   "
        @iftime1
        " ==  "
        @iftime2
      )
    )
  )
  else
  (
    print
    (
      str
      (
        "1.  PASS   "
        @iftime1
        "!="
        @iftime2
        "    "
        @time
        "   "
        @notestime
      )
    )
  )
  if
  ^ 判断员工登录日志信息
  (
    equal
    (
      @notes
      @loginnote
    )
    print
    (
      str
      (
        "2.   PASS   "
        @notes
        " ==  "
        @loginnote
      )
    )
  )
  else
  (
    print
    (
      str
      (
        "2.  PASS   "
        @notes
        "!="
        @loginnote
      )
    )
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"nav-item-14\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"nav-item-15\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @hintinfo
    webElementValue
    ^ 获取无权限提示信息
    (
      @app
      "xpath"
      "//*[@id=\"employee-no-permission\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @accname
    webElementValue
    (
      @app
      "xpath"
      "//*[@id=\"account-list-row-0\"]/td[2]"
      100
      3
      "innerHTML"
    )
  )
  if
  ^ 判断页面无权限提示，以及账号信息按钮是否屏蔽
  (
    equal
    (
      @acctitle
      str
      (
        @hintinfo
        @accname
      )
    )
    print
    (
      str
      (
        "3.  PASS   "
        @acctitle
        "=="
        @hintinfo
        @accname
      )
    )
  )
  else
  (
    print
    (
      str
      (
        "3.   FALSE   "
        @acctitle
        "!="
        @hintinfo
        @accname
      )
    )
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"nav-item-18\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementClick
  ^ 点击退出登录
  (
    @app
    "xpath"
    "//*[@id=\"sign-out-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementInput
  ^ 输入账号
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-email\"]"
    100
    3
    "riotestee@qq.com"
  )
  webPageElementInput
  ^ 输入密码
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @password
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"agr-checkbox\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  ^ 点击登录
  (
    @app
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    8
    0
    0
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"nav-item-14\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  (
    @app
    "xpath"
    "//*[@id=\"nav-item-15\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @accname1
    webElementValue
    ^ 获取账号名称标题
    (
      @app
      "xpath"
      "//*[@id=\"account_name\"]//*[@id=\"lbl-\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @finish1
    webElementValue
    ^ 获取新增按钮是否存在
    (
      @app
      "xpath"
      "//*[@id=\"account-list-tab\"]//*[@id=\"add-account-btn\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @hintinfo1
    webElementValue
    ^ 获取无权限提示信息
    (
      @app
      "xpath"
      "//*[@id=\"employee-no-permission\"]"
      100
      3
      "innerHTML"
    )
  )
  if
  ^ 判断页面无权限提示，以及账号信息按钮是否屏蔽
  (
    equal
    (
      @acctitle
      str
      (
        @hintinfo1
        @accname1
      )
    )
    print
    (
      str
      (
        "4.  PASS   "
        @acctitle
        "=="
        @hintinfo1
        @accname1
      )
    )
  )
  else
  (
    print
    (
      str
      (
        "4.   FALSE   "
        @acctitle
        "!="
        @hintinfo1
        @accname1
      )
    )
  )
  webBrowserPage
  ^ 去掉员工账号刷新页面，查看是否退出到登录页面
  (
    @app
    @path
  )
  sleep
  (
    8
    0
    0
  )
  assign
  (
    @signJson
    webElementInfo
    (
      @app
      "xpath"
      "//*[@id=\"sign-in-act\"]"
      100
      3
    )
  )
  assign
  (
    @displayed
    sel
    (
      @signJson
      'displayed'
    )
  )
  if
  (
    assign
    (
      @displayed
      sel
      (
        @signJson
        'displayed'
      )
    )
    print
    (
      "5. PASS Sign in Page"
    )
  )
  else
  (
    print
    (
      "5. FALSE Sign in Page"
    )
  )
  pause
  (
  )
)
