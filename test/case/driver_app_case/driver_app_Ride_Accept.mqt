sequence
(
  args
  (
    keyValue
    (
      "@fltPath"
      "https://elifetransfer.s3.us-east-2.amazonaws.com/dev/Driver_app/driver_app.html"
    )
    keyValue
    (
      "@email"
      "RioAccept@qq.com"
    )
    keyValue
    (
      "@emailed"
      "RioAccepted@qq.com"
    )
    keyValue
    (
      "@pwd"
      "riotest"
    )
    keyValue
    (
      "@rideIdList"
      "116214,116216,116215,116216"
    )
    keyValue
    (
      "@sumTime"
      "960,1080,1920,2040"
    )
    keyValue
    (
      "@utcTime"
      "480,600,1440,1560"
    )
  )
  assign
  (
    @_resumeInterval
    valueOf
    (
      100
    )
  )
  assign
  (
    @db
    dbSqlConn
    (
      "com.mysql.jdbc.Driver"
      str
      (
        "jdbc:mysql://"
        "rideprod.c9y2b7qgnkr8.us-east-2.rds.amazonaws.com"
        ":"
        3306
      )
      "dev_user"
      "0TAnwLmMzDbCYMuf"
    )
  )
  assign
  (
    @sumTimeList
    split
    (
      @sumTime
      ","
    )
  )
  assign
  (
    @utcTimeList
    split
    (
      @utcTime
      ","
    )
  )
  assign
  (
    @RideList
    split
    (
      @rideIdList
      ","
    )
  )
  loopStream
  ^ 循环修改订单时间
  (
    @f1
    streamRange
    (
      0
      4
      1
    )
    assign
    (
      @times
      sel
      (
        @sumTimeList
        @f1
      )
    )
    assign
    (
      @rideid
      sel
      (
        @RideList
        @f1
      )
    )
    assign
    (
      @timeSQL1
      valueOf
      (
        str
        (
          "(SELECT date_format(DATE_ADD(NOW(), INTERVAL '"
          @times
          "' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL)"
        )
      )
    )
    assign
    (
      @times
      sel
      (
        @utcTimeList
        @f1
      )
    )
    assign
    (
      @timeSQL2
      valueOf
      (
        str
        (
          "(SELECT date_format(DATE_ADD(NOW(), INTERVAL '"
          @times
          "' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL)"
        )
      )
    )
    if
    (
      equal
      (
        @f1
        3
      )
      tableStream
      (
        streamDbSql
        (
          @db
          str
          (
            "update ride.ride set to_utc = (select unix_timestamp("
            @timeSQL2
            ")), to_time_str ="
            @timeSQL1
            "  where id = "
            @rideid
            ";"
          )
        )
      )
      tableStream
      (
        streamDbSql
        (
          @db
          str
          (
            "update ride.dispatch set from_utc = (select unix_timestamp("
            @timeSQL2
            ")) where ride_id ='"
            @rideid
            "' and id = '45011';"
          )
        )
      )
    )
    else
    (
      tableStream
      (
        streamDbSql
        (
          @db
          str
          (
            "update ride.ride set from_utc = (select unix_timestamp("
            @timeSQL2
            ")), from_time_str ="
            @timeSQL1
            "  where id = "
            @rideid
            ";"
          )
        )
      )
      tableStream
      (
        streamDbSql
        (
          @db
          str
          (
            "update ride.dispatch set from_utc = (select unix_timestamp("
            @timeSQL2
            ")) where ride_id ='"
            @rideid
            "';"
          )
        )
      )
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.dispatch set stat = '134217736', fleet_driver_id = null, meeting_place_id=null, reversal=null,trip_no_x=null where to_fleet_id in ('11466','11468') and ride_id in (116214,116216,116215,116216);"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.ride set dispatch_fleet_id = null where dispatch_fleet_id in ('11466','11468');"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "delete from ride.auction_bid where auction_id in (select auction_id from ride.auction_fleet where fleet_id in ('11466','11468'));"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.auction set fleet_id = null where id in (select auction_id from ride.auction_fleet where fleet_id in ('11466','11468'));"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "delete from ride.dispatch_prepayment where dispatch_id in (select id from ride.dispatch where to_fleet_id in ('11466','11468'));"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "delete from ride.note_dispatch where dispatch_id in (select id from ride.dispatch where to_fleet_id in ('11466','11468'));"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.auction_ride set trip_no_x = 0 where auction_id in (select auction_id from ride.auction_fleet where auction_id in (3811,3812,3813));"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.auction_ride set trip_no_x = 1 where auction_id in (select auction_id from ride.auction_fleet where fleet_id = '11466' and auction_id = '3814');"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.auction_fleet set amount = '66.66' where auction_id = '3813' and id = '155';"
    )
  )
  assign
  (
    @chr
    webBrowser
    (
      "Chrome"
    )
  )
  webBrowserPage
  (
    @chr
    @fltPath
  )
  webPageElementInput
  (
    @chr
    "xpath"
    "//*[@id=\"sign-in-email\"]"
    100
    3
    @email
  )
  webPageElementInput
  (
    @chr
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @pwd
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    12
    0
    0
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.auction set start_utc = (select unix_timestamp((SELECT date_format(DATE_ADD(NOW(), INTERVAL '2' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL))),start_time_str = (SELECT date_format(DATE_ADD(NOW(), INTERVAL '482' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL) where id = '3812';"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.auction set start_utc = (select unix_timestamp((SELECT date_format(DATE_ADD(NOW(), INTERVAL '4' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL))),start_time_str = (SELECT date_format(DATE_ADD(NOW(), INTERVAL '484' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL) where id = '3814';"
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"fcm-notify-denied-msg\"]//*[@id=\"confirm-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"version_modal\"]//*[@id=\"close-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"announcement_modal\"]//*[@id=\"close-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  ^ 点击第三笔订单accept按钮接单
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-2\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementClick
  ^ 点击ok
  (
    @chr
    "xpath"
    "//*[@id=\"error-modal-close-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  ^ 刷新订单列表
  (
    @chr
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementClick
  ^ 点击第三笔订单accept按钮接单
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-2\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  assign
  (
    @ch2
    webBrowser
    (
      "Chrome"
    )
  )
  webBrowserPage
  (
    @ch2
    @fltPath
  )
  webPageElementInput
  (
    @ch2
    "xpath"
    "//*[@id=\"sign-in-email\"]"
    100
    3
    @emailed
  )
  webPageElementInput
  (
    @ch2
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @pwd
  )
  webPageElementClick
  (
    @ch2
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    15
    0
    0
  )
  webPageElementClick
  (
    @ch2
    "xpath"
    "//*[@id=\"fcm-notify-denied-msg\"]//*[@id=\"confirm-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @ch2
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"version_modal\"]//*[@id=\"close-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @ch2
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"announcement_modal\"]//*[@id=\"close-btn\"]"
    100
    3
    0
    1
  )
  assign
  (
    @rideTime
    webElementValue
    (
      @ch2
      "xpath"
      "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-2\"]/div[2]/div[1]/div[1]/span[2]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @newTime
    dateTimeNow
    (
    )
  )
  assign
  (
    @time
    dateTimeFormat
    (
      @newTime
      "yyyy-MM-dd HH:mm:ss"
    )
  )
  assign
  (
    @_
    tableStream
    (
      streamDbSql
      (
        @db
        str
        (
          "SELECT TIMESTAMPDIFF(Second,'"
          @time
          "', '"
          @rideTime
          ":00');"
        )
      )
    )
  )
  assign
  (
    @times
    selInPlace
    (
      @_
      0
      0
    )
  )
  print
  (
    @times
  )
  assign
  (
    @rideTime
    webElementValue
    (
      @ch2
      "xpath"
      "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-3\"]/div[2]/div[1]/div[1]/span[2]"
      100
      3
      "innerHTML"
    )
  )
  if
  (
    greaterEqual
    (
      @times
      0
    )
    sleep
    (
      @times
      0
      0
    )
  )
  webPageElementClick
  ^ 刷新订单列表
  (
    @chr
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  ^ 刷新订单列表
  (
    @ch2
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementClick
  ^ 点击第三笔订单抢单
  (
    @ch2
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-2\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    8
    0
    0
  )
  webPageElementClick
  ^ 点击第三笔订单抢单
  (
    @ch2
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-2\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  ^ 点击第四笔订单查看详情
  (
    @ch2
    "xpath"
    "//*[@id=\"bid-rides-list\"]/div[3]//*[@id=\"bid-rides-list-row-3\"]/div[2]/div[1]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  ^ 查看页面抢单时间ui，按钮是否置灰，点击Accept按钮，点击无效
  (
    @ch2
    "xpath"
    "//*[@id=\"bid-act-box-realbid\"]"
    100
    3
    0
    1
  )
  webTabSwitchTo
  ^ 切换第一个账号页面
  (
    @chr
    0
  )
  webPageElementClick
  ^ 账号1点击第三笔订单抢单
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-2\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  ^ 点击ok
  (
    @chr
    "xpath"
    "//*[@id=\"error-modal-close-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  ^ 点击第一笔订单id，查看订单详情
  (
    @chr
    "xpath"
    "//*[@id=\"bid-rides-list\"]/div[3]//*[@id=\"bid-rides-list-row-0\"]/div[2]/div[1]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  ^ 点击抢单
  (
    @chr
    "xpath"
    "//*[@id=\"bid-act-realbid\"]"
    100
    3
    0
    1
  )
  sleep
  (
    6
    0
    0
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.auction_fleet set amount = '120' where auction_id = '3813' and id = '155';"
    )
  )
  webPageElementClick
  ^ 点击第二笔订单accept
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-1\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-around-tab-confirm-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  ^ 点击ok
  (
    @chr
    "xpath"
    "//*[@id=\"error-modal-close-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  ^ 刷新列表
  (
    @chr
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"bid-rides-list\"]/div[3]//*[@id=\"bid-rides-list-row-0\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  ^ 点击第一笔订单accept
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-rides-list-row-0\"]//*[@id=\"out-bid-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"bid-around-tab-confirm-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webTabSwitchTo
  ^ 切换到账号2窗口
  (
    @ch2
    0
  )
  assign
  (
    @newTime
    dateTimeNow
    (
    )
  )
  assign
  (
    @time
    dateTimeFormat
    (
      @newTime
      "yyyy-MM-dd HH:mm:ss"
    )
  )
  assign
  (
    @_
    tableStream
    (
      streamDbSql
      (
        @db
        str
        (
          "SELECT TIMESTAMPDIFF(Second,'"
          @time
          "', '"
          @rideTime
          ":00');"
        )
      )
    )
  )
  assign
  (
    @times
    selInPlace
    (
      @_
      0
      0
    )
  )
  print
  (
    @times
  )
  if
  (
    greaterEqual
    (
      @times
      0
    )
    sleep
    (
      @times
      0
      0
    )
  )
  webPageElementClick
  ^ 点击accept
  (
    @ch2
    "xpath"
    "//*[@id=\"bid-act-realbid\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @ch2
    "xpath"
    "//*[@id=\"bid-around-tab-confirm-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  ^ 点击booked
  (
    @ch2
    "xpath"
    "//*[@id=\"orders-booked-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    7
    0
    0
  )
  webPageElementClick
  ^ 查看第一笔订单详情
  (
    @ch2
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]/div/div[2]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  assign
  (
    @rideid1
    webElementValue
    (
      @ch2
      "xpath"
      "//*[@id=\"dispatch_detail\"]//*[@id=\"dispatch-detail-form\"]//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  webPageElementClick
  (
    @ch2
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"detail-back\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  ^ 查看第二笔订单详情
  (
    @ch2
    "xpath"
    "//*[@id=\"rides-list-row-1\"]/div/div[2]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  assign
  (
    @rideid2
    webElementValue
    (
      @ch2
      "xpath"
      "//*[@id=\"dispatch_detail\"]//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  webTabSwitchTo
  ^ 切换到账号1窗口
  (
    @chr
    0
  )
  webPageElementClick
  ^ 点击booked
  (
    @chr
    "xpath"
    "//*[@id=\"orders-booked-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    8
    0
    0
  )
  webPageElementClick
  ^ 查看第一笔订单详情
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]/div/div[2]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  assign
  (
    @rideid3
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"dispatch_detail\"]//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"detail-back\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  ^ 点击查看第二笔订单详情
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list-row-1\"]/div/div[2]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @rideid4
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"dispatch_detail\"]//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  if
  (
    equal
    (
      "116215-1,116216-2,116214-1,116216-1"
      str
      (
        @rideid1
        ","
        @rideid2
        ","
        @rideid3
        ","
        @rideid4
      )
    )
    print
    (
      str
      (
        "1.   PASS  116215-1,116216-2,116214-1,116216-1 == "
        @rideid1
        ","
        @rideid2
        ","
        @rideid3
        ","
        @rideid4
      )
    )
  )
  else
  (
    print
    (
      str
      (
        "1.   FALSE  116215-1,116216-2,116214-1,116216-1 != "
        @rideid1
        ","
        @rideid2
        ","
        @rideid3
        ","
        @rideid4
      )
    )
  )
  pause
  (
  )
)
