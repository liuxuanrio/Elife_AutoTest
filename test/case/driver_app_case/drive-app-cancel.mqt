sequence
(
  args
  (
    keyValue
    (
      "@email"
      "rioCancel@qq.com"
    )
    keyValue
    (
      "@pwd"
      "riotest"
    )
    keyValue
    (
      "@path"
      "https://elifetransfer.s3.us-east-2.amazonaws.com/dev/Driver_app/driver_app.html"
    )
    keyValue
    (
      "@state"
      "Cancelled"
    )
    keyValue
    (
      "@popup"
      "The ride had been cancelled!"
    )
  )
  assign
  (
    @_resumeInterval
    valueOf
    (
      1
    )
  )
  assign
  (
    @db
    dbSqlConn
    (
      "com.mysql.jdbc.Driver"
      str
      (
        "jdbc:mysql://"
        "rideprod.c9y2b7qgnkr8.us-east-2.rds.amazonaws.com"
        ":"
        3306
      )
      "dev_user"
      "0TAnwLmMzDbCYMuf"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "use ride"
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      "update ride.dispatch set stat = '134217730',trip_no_x = 0,reversal = null where to_fleet_id = '11854' and ride_id in (127006, 127007, 127108, 127109);"
    )
  )
  assign
  (
    @chr
    webBrowser
    (
      "Chrome"
    )
  )
  webBrowserPage
  (
    @chr
    @path
  )
  webPageElementInput
  (
    @chr
    "xpath"
    "//*[@id=\"sign-in-email\"]"
    100
    3
    @email
  )
  webPageElementInput
  (
    @chr
    "xpath"
    "//*[@id=\"sign-in-password\"]"
    100
    3
    @pwd
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"sign-in-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    15
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"fcm-notify-denied-msg\"]//*[@id=\"confirm-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"version_modal\"]//*[@id=\"close-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"container-fluid\"]//*[@id=\"announcement_modal\"]//*[@id=\"close-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"orders-booked-act\"]"
    100
    3
    0
    1
  )
  sleep
  (
    8
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    5
    0
    0
  )
  assign
  (
    @ridestr1
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"dispatch_detail\"]//*[@id=\"dispatch-detail-form\"]//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @ridelist1
    split
    (
      @ridestr1
      "-"
    )
  )
  assign
  (
    @ride1
    sel
    (
      @ridelist1
      0
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.dispatch set stat = '134217736',trip_no_x = null,reversal = 1.00 where to_fleet_id = '11854' and ride_id = '"
        @ride1
        "';
"
      )
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"on-my-way\"]"
    100
    3
    0
    1
  )
  sleep
  (
    6
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"confirm-start\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @ifpopup1
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"ride-cancelled-popup\"]/div"
      100
      3
      "innerHTML"
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"ride-cancelled-popup\"]/div"
    100
    3
    0
    1
  )
  assign
  (
    @ifstate1
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"order-info\"]//*[@id=\"stat-cancelled\"]"
      100
      3
      "innerHTML"
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"detail-back\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]/div[1]/div[3]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @ridestr2
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"dispatch_detail\"]//*[@id=\"dispatch-detail-form\"]//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @ridelist2
    split
    (
      @ridestr2
      "-"
    )
  )
  assign
  (
    @ride2
    sel
    (
      @ridelist2
      0
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"detail-back\"]"
    100
    3
    0
    1
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.ride set from_utc = (select unix_timestamp(
(SELECT date_format(DATE_ADD(NOW(), INTERVAL '241' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL)
)), from_time_str = (SELECT date_format(DATE_ADD(NOW(), INTERVAL '721' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL)  where id = '"
        @ride2
        "';
"
      )
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.dispatch set from_utc = (select unix_timestamp(
(SELECT date_format(DATE_ADD(NOW(), INTERVAL '241' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL))) where ride_id = '"
        @ride2
        "';
"
      )
    )
  )
  assign
  (
    @_
    tableStream
    (
      streamDbSql
      (
        @db
        "SELECT date_format(DATE_ADD(NOW(), INTERVAL '481' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL;
"
      )
    )
  )
  assign
  (
    @time2
    selInPlace
    (
      @_
      0
      0
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]/div[1]/div[3]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.dispatch set stat = '134217736',trip_no_x = null,reversal = 1.00 where to_fleet_id = '11854' and ride_id = '"
        @ride2
        "';
"
      )
    )
  )
  assign
  (
    @Now
    dateTimeNow
    (
    )
  )
  assign
  (
    @nowtime
    dateTimeFormat
    (
      @Now
      "yyyy-MM-dd HH:mm:ss"
    )
  )
  assign
  (
    @_
    tableStream
    (
      streamDbSql
      (
        @db
        str
        (
          "SELECT TIMESTAMPDIFF(Second, '"
          @nowtime
          "',  '"
          @time2
          ":00');
"
        )
      )
    )
  )
  assign
  (
    @sumtime
    selInPlace
    (
      @_
      0
      0
    )
  )
  print
  (
    @sumtime
  )
  if
  (
    greaterEqual
    (
      @sumtime
      0
    )
    sleep
    (
      @sumtime
      0
      0
    )
  )
  assign
  (
    @ifpopup2
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"ride-cancelled-popup\"]/div"
      100
      3
      "innerHTML"
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"ride-cancelled-popup\"]/div"
    100
    3
    0
    1
  )
  assign
  (
    @ifstate2
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"stat-cancelled\"]"
      100
      3
      "innerHTML"
    )
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"detail-back\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]/div[1]/div[3]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"change-driver-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch-div\"]/div/div[3]//*[@id=\"driver-search-field-dropdowns\"]//*[@id=\"item-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  assign
  (
    @tokenstr
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"pay-link-fld\"]"
      100
      3
      "value"
    )
  )
  assign
  (
    @tokenlist
    split
    (
      @tokenstr
      "="
    )
  )
  assign
  (
    @token
    sel
    (
      @tokenlist
      1
    )
  )
  assign
  (
    @chr1
    webBrowser
    (
      "Chrome"
    )
  )
  webBrowserPage
  (
    @chr1
    str
    (
      @path
      "?t="
      @token
    )
  )
  sleep
  (
    2
    0
    0
  )
  assign
  (
    @ridestr3
    webElementValue
    (
      @chr1
      "xpath"
      "//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @ridelist3
    split
    (
      @ridestr3
      "-"
    )
  )
  assign
  (
    @ride3
    sel
    (
      @ridelist3
      0
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.dispatch set stat = '134217736',trip_no_x = null,reversal = 1.00 where to_fleet_id = '11854' and ride_id = '"
        @ride3
        "';
"
      )
    )
  )
  webPageElementClick
  (
    @chr1
    "xpath"
    "//*[@id=\"on-my-way\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  webPageElementClick
  (
    @chr1
    "xpath"
    "//*[@id=\"confirm-start\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @ifpopup3
    webElementValue
    (
      @chr1
      "xpath"
      "//*[@id=\"ride-cancelled-popup\"]/div"
      100
      3
      "innerHTML"
    )
  )
  webPageElementClick
  (
    @chr1
    "xpath"
    "//*[@id=\"ride-cancelled-popup\"]/div"
    100
    3
    0
    1
  )
  webBrowserPage
  (
    @chr1
    str
    (
      @path
      "?t="
      @token
    )
  )
  webPageElementClick
  (
    @chr1
    "xpath"
    "//*[@id=\"ride-cancelled-popup\"]/div"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @ifstate3
    webElementValue
    (
      @chr1
      "xpath"
      "//*[@id=\"stat-cancelled\"]"
      100
      3
      "innerHTML"
    )
  )
  webTabSwitchTo
  (
    @chr
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"pay-link-cpy-close-btn\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"detail-back\"]"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"index_rides_mgmt\"]/div[1]/div[3]//*[@id=\"rides-reload-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    4
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"rides-list\"]/div[2]//*[@id=\"rides-list-row-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"change-driver-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    1
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch_detail\"]//*[@id=\"change-driver-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  webPageElementClick
  (
    @chr
    "xpath"
    "//*[@id=\"dispatch-div\"]/div/div[3]//*[@id=\"driver-search-field-dropdowns\"]//*[@id=\"item-0\"]"
    100
    3
    0
    1
  )
  sleep
  (
    2
    0
    0
  )
  assign
  (
    @tokenstr
    webElementValue
    (
      @chr
      "xpath"
      "//*[@id=\"pay-link-fld\"]"
      100
      3
      "value"
    )
  )
  assign
  (
    @tokenlist
    split
    (
      @tokenstr
      "="
    )
  )
  assign
  (
    @token
    sel
    (
      @tokenlist
      1
    )
  )
  webTabSwitchTo
  (
    @chr1
    0
  )
  webBrowserPage
  (
    @chr1
    str
    (
      @path
      "?t="
      @token
    )
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @ridestr4
    webElementValue
    (
      @chr1
      "xpath"
      "//*[@id=\"ride-id\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @ridelist4
    split
    (
      @ridestr4
      "-"
    )
  )
  assign
  (
    @ride4
    sel
    (
      @ridelist4
      0
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.ride set from_utc = (select unix_timestamp(
(SELECT date_format(DATE_ADD(NOW(), INTERVAL '241' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL)
)), from_time_str = (SELECT date_format(DATE_ADD(NOW(), INTERVAL '721' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL)  where id = '"
        @ride4
        "';
"
      )
    )
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.dispatch set from_utc = (select unix_timestamp(
(SELECT date_format(DATE_ADD(NOW(), INTERVAL '241' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL))) where ride_id = '"
        @ride4
        "';
"
      )
    )
  )
  assign
  (
    @_
    tableStream
    (
      streamDbSql
      (
        @db
        "SELECT date_format(DATE_ADD(NOW(), INTERVAL '482' MINUTE), '%Y-%m-%d %H:%i') FROM DUAL;
"
      )
    )
  )
  assign
  (
    @time4
    selInPlace
    (
      @_
      0
      0
    )
  )
  webBrowserPage
  (
    @chr1
    str
    (
      @path
      "?t="
      @token
    )
  )
  sleep
  (
    3
    0
    0
  )
  tableStream
  (
    streamDbSql
    (
      @db
      str
      (
        "update ride.dispatch set stat = '134217736',trip_no_x = null,reversal = 1.00 where to_fleet_id = '11854' and ride_id = '"
        @ride4
        "';
"
      )
    )
  )
  assign
  (
    @Now
    dateTimeNow
    (
    )
  )
  assign
  (
    @nowtime
    dateTimeFormat
    (
      @Now
      "yyyy-MM-dd HH:mm:ss"
    )
  )
  assign
  (
    @_
    tableStream
    (
      streamDbSql
      (
        @db
        str
        (
          "SELECT TIMESTAMPDIFF(Second, '"
          @nowtime
          "',  '"
          @time4
          ":00');
"
        )
      )
    )
  )
  assign
  (
    @sumtime
    selInPlace
    (
      @_
      0
      0
    )
  )
  print
  (
    @sumtime
  )
  if
  (
    greaterEqual
    (
      @sumtime
      0
    )
    sleep
    (
      @sumtime
      0
      0
    )
  )
  assign
  (
    @ifpopup4
    webElementValue
    (
      @chr1
      "xpath"
      "//*[@id=\"ride-cancelled-popup\"]/div"
      100
      3
      "innerHTML"
    )
  )
  webBrowserPage
  (
    @chr1
    str
    (
      @path
      "?t="
      @token
    )
  )
  sleep
  (
    5
    0
    0
  )
  webPageElementClick
  (
    @chr1
    "xpath"
    "//*[@id=\"ride-cancelled-popup\"]/div"
    100
    3
    0
    1
  )
  webPageElementClick
  (
    @chr1
    "xpath"
    "//*[@id=\"fcm-notify-denied-msg\"]//*[@id=\"confirm-btn\"]"
    100
    3
    0
    1
  )
  sleep
  (
    3
    0
    0
  )
  assign
  (
    @_resumeInterval
    valueOf
    (
      100
    )
  )
  assign
  (
    @ifstate4
    webElementValue
    (
      @chr1
      "xpath"
      "//*[@id=\"stat-cancelled\"]"
      100
      3
      "innerHTML"
    )
  )
  assign
  (
    @iflist
    valueOf
    (
      str
      (
        @ride1
        "-"
        @ifpopup1
        "-"
        @ifstate1
        ","
        @ride2
        "-"
        @ifpopup2
        "-"
        @ifstate2
        ","
        @ride3
        "-"
        @ifpopup3
        "-"
        @ifstate3
        ","
        @ride4
        "-"
        @ifpopup4
        "-"
        @ifstate4
      )
    )
  )
  assign
  (
    @expectlist
    valueOf
    (
      str
      (
        @ride1
        "-"
        @popup
        "-"
        @state
        ","
        @ride2
        "-"
        @popup
        "-"
        @state
        ","
        @ride3
        "-"
        @popup
        "-"
        @state
        ","
        @ride4
        "-"
        @popup
        "-"
        @state
      )
    )
  )
  assign
  (
    @iflists
    split
    (
      @iflist
      ","
    )
  )
  assign
  (
    @exps
    split
    (
      @expectlist
      ","
    )
  )
  loopStream
  (
    @f
    streamRange
    (
      0
      4
      1
    )
    assign
    (
      @ifinfo
      sel
      (
        @iflists
        @f
      )
    )
    assign
    (
      @info
      sel
      (
        @exps
        @f
      )
    )
    if
    (
      equal
      (
        @ifinfo
        @info
      )
      print
      (
        str
        (
          @f
          ".  PASS "
          @ifinfo
          " == "
          @info
        )
      )
    )
    else
    (
      print
      (
        str
        (
          @f
          ".  FALSE "
          @ifinfo
          " != "
          @info
        )
      )
    )
    print
    (
      "------"
    )
  )
  pause
  (
  )
)
